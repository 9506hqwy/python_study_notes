# 書式指定出力

## `%` 指定

タプルまたは辞書で値を指定して文字列を出力する。

```text
"<フォーマット文字列>" % (値、...)
```

フォーマット文字列は下記の形式となる。

```text
'%' + [(辞書のキー)] + [0+= #] + [最小幅] + [.精度] + <形式>
```

| 項目         | 説明                                             |
| ------------ | ------------------------------------------------ |
| (辞書のキー) | 値を辞書で指定した場合にキーを指定する。         |
| 0            | 数字の場合に 0 で右詰する。                      |
| +            | 正の数の場合に + を付与する。                    |
| -            | 左詰する。                                       |
| 空白         | 正の数の場合に空白で右詰する。                   |
| #            | 代替形式で表示する。                             |
| 最小幅       | 出力幅を指定する。`*` の場合は引数から取得する。 |
| .精度        | 精度または文字数を指定する。                     |
| 形式         | o, d, x, e, f, g, c, r, s a, %                   |

```python
> print("%(value)06.2f" % {"value": 12.3})
012.30
> print("%0*.2f" % (6, 12.3))
012.30
```

### 参照

- [printf 形式の文字列書式化](https://docs.python.org/ja/3/library/stdtypes.html#old-string-formatting)

## `format` メソッド

`%` 指定とは別の形式のフォーマット文字列を指定する。

```text
"<フォーマット文字列>".format(値、...)
```

フォーマット文字列は下記の形式となる。

```text
'{' + [名前] + ['!' + [ars]] + [':' + [X] + [<>=^] + [+- ] + ['z'] + ['#'] + ['0'] + [最小幅] + [,_] + [.精度] * [形式]] + '}'
```

| 項目   | 説明                                         |
| ------ | -------------------------------------------- |
| 名前   | シーケンスのインデックス、辞書のキー         |
| !a     | `%` 指定の `%a` と同じ                       |
| !r     | `%` 指定の `%r` と同じ                       |
| !s     | `%` 指定の `%s` と同じ                       |
| X      | 指定した文字で詰め                           |
| <      | 左寄せ                                       |
| >      | 右寄せ                                       |
| =      | 符号を付与して X で詰め                      |
| ^      | センタリング                                 |
| +      | 正負に関係なく符号を付与                     |
| -      | 負の数の場合に符号を付与                     |
| 空白   | 正の数の場合は空白、負の数の場合は符号を付与 |
| z      | 浮動小数点の -0 を 0 に変換                  |
| #      | 代替形式                                     |
| 0      | 0 詰め                                       |
| 最小幅 | 出力幅を指定する。                           |
| ,      | 数字の3桁ごとに , で区切る                   |
| _      | 数字の3桁ごとに _ で区切る                   |
| .精度  | 精度または文字数を指定する。                 |
| 形式   | b, o, d, x, e, ,f , g, c, s, n, %            |

```python
> print("{value:06.2f}".format(value=12.3))
012.30
```

### 参照

- [書式指定文字列の文法](https://docs.python.org/ja/3/library/string.html#formatstrings)

## 文字列補間 (f-strings)

リテラル中に式を指定する。

```python
f"{式[:<フォーマット文字列>]}"
```

Python 3.11 以前は式内で `\` を使用することはできない。
そのため f-strings を `"` を囲むと式内で `"` をエスケープできず使用できない。`'` の場合も同じ。
また、`#` も使用できないためコメントもできない。

### 参照

- [PEP 498 – Literal String Interpolation](https://peps.python.org/pep-0498/)
- [PEP 701 – Syntactic formalization of f-strings](https://peps.python.org/pep-0701/)
